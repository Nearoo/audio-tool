(this["webpackJsonpaudio-tool"]=this["webpackJsonpaudio-tool"]||[]).push([[0],{230:function(e,t,n){},300:function(e,t,n){},397:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),c=n(56),u=n.n(c),a=(n(230),n(407)),i=n(406),s=(n(168),n(411)),d=n(408),l={sampler:[]};["Clap","Cow","Hihat1_closed","Hihat3_closed","Hihat_open","Kick","Snare","Snare3","Snare5","Clap2","Crash","Hihat2_closed","Hihat4_closed","Hihat_open_2","Kick2","Snare2","Snare4"].forEach((function(e){return l.sampler.push({name:"808 ".concat(e),data:{loop:!1,path:"808/".concat(e)}})}));var f=n(19),p=function(e){return Object(f.jsx)(s.a,{style:{margin:10},children:Object.keys(l).map((function(e){return Object(f.jsx)(s.a.Panel,{header:e,children:Object(f.jsx)(d.b,{size:"small",bordered:!0,dataSource:l[e],renderItem:function(t){return Object(f.jsx)(d.b.Item,{draggable:!0,onDragStart:function(n){n.dataTransfer.setData("audio-tool/node-preset",JSON.stringify({type:e,data:t.data})),n.dataTransfer.effectAllowed="move"},children:t.name},t.name)}})},e)}))})},b=(n(300),n(301),n(23)),h=n(409),g=n(70),j=n(1),O=new function e(){var t=this;Object(j.a)(this,e),this.registerNode=function(e,n){t.nodeMap[n]=e},this.deregisterNode=function(e){delete t.nodeMap[e]},this.connectNodes=function(e,n){t.nodeMap[e].connect(t.nodeMap[n])},this.disconnectNodes=function(e,n){var r;null===(r=t.nodeMap[e])||void 0===r||r.disconnect(t.nodeMap[n])},this.isAudioNode=function(e){return e in t.nodeMap},this.areConnected=function(e,n){return t.nodeMap[e].is},this.nodeMap={}},v=new function e(){var t=this;Object(j.a)(this,e),this.registerOutputNode=function(e){return e in t.triggererMap||(t.triggererMap[e]=new Set),t.getTriggerCallbackForOutputNode(e)},this.getTriggerCallbackForOutputNode=function(e){return function(n,r){var o;return(null!==(o=t.triggererMap[e])&&void 0!==o?o:new Set).forEach((function(e){return t.triggereeMap[e](n,r)}))}},this.deregisterOutputNode=function(e){t.triggererMap[e].forEach((function(n){return t.disconnectNodes(e,n)})),delete t.triggererMap[e]},this.registerInputNode=function(e,n){var r=e;t.triggereeMap[r]=n},this.deregisterInputNode=function(e){delete t.triggereeMap[e]},this.connectNodes=function(e,n){t.triggererMap[e].add(n)},this.disconnectNodes=function(e,n){var r;null===(r=t.triggererMap[e])||void 0===r||r.delete(n)},this.isBangNode=function(e){return e in t.triggereeMap||e in t.triggererMap},this.triggereeMap={},this.triggererMap={}},m=n(10),I=n(26),E=n(4),x=n(5),y=n(75),S=n.n(y),N=n(413),k=o.a.createContext({}),w=function(e){Object(E.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(j.a)(this,n),(r=t.call(this,e)).localStorageKey="graph",r.createUniqueId=function(){return Object(N.a)()},r.pushElement=function(e){r.setState((function(t){return{elements:[].concat(Object(I.a)(t.elements),[e])}}))},r.pullElement=function(e){r.pullElementById(e.id)},r.pullElementById=function(e){r.setState((function(t){return{elements:S.a.reject(t.elements,{id:e})}}))},r.pullElementByPredicate=function(e){r.setState((function(t){return{elements:S.a.filter(t.elements,(function(t){return!e(t)}))}}))},r.replaceElementById=function(e,t){r.setState((function(n){return{elements:n.elements.map((function(n){return n.id===e?t:n}))}}))},r.getElementById=function(e){return r.state.elements.find((function(t){return t.id===e}))},r.createNode=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.createUniqueId();r.pushElement({type:e,id:o,position:t,data:n})},r.createEdge=function(e,t,n,o,c){var u=r.createUniqueId();r.pushElement({id:u,sourceHandle:t,targetHandle:o,source:e,target:n,type:c})},r.setNodeData=function(e,t){var n=r.getElementById(e);r.replaceElementById(e,Object(m.a)(Object(m.a)({},n),{},{data:t}))},r.getNodeData=function(e){return r.getElementById(e).data},r.deleteEdgesConnectedToHandle=function(e){r.pullElementByPredicate((function(t){return t.sourceHandle===e||t.targetHandle===e}))},r.render=function(){return Object(f.jsx)(k.Provider,{value:r.state,children:r.props.children})},r.state={elements:[],setElements:function(e){return r.setState({elements:e})},reactFlowInstance:null,setReactFlowInstance:function(e){return r.setState({reactFlowInstance:e})},createNode:r.createNode,setNodeData:r.setNodeData,getNodeData:r.getNodeData,createEdge:r.createEdge,deleteElement:r.pullElement,deleteEdgesConnectedToHandle:r.deleteEdgesConnectedToHandle},r}return n}(r.Component),C=n(63),H=n(9),T=n(164),B=n.n(T),A=n(73),D=n(17),R=function e(t,n){Object(j.a)(this,e),this.bpm=t,this.ppb=n,this.pulsePerSecond=n*t/60,this.secondPerPulse=1/this.pulsePerSecond},P=function e(t,n){var r=this;Object(j.a)(this,e),this.toSeconds=function(){return r.pulse/r.res.pulsePerSecond},this.toPulse=function(){return r.pulse},this.add=function(t){return new e(r.pulse+t.pulse,r.res)},this.subtract=function(t){return new e(r.pulse-t.pulse,r.res)},this.multiply=function(t){return new e(r.pulse*t,r.res)},this.isBefore=function(e){return r.toSeconds()<e.toSeconds()},this.isAfter=function(e){return r.toSeconds()>e.toSeconds()},this.isOnOrBefore=function(e){return!r.isAfter(e)},this.isOnOrAfter=function(e){return!r.isBefore(e)},this.isNever=function(){return r.pulse===Number.POSITIVE_INFINITY},this.pulse=t,this.res=n};P.fromSeconds=function(e,t){var n=e%t.secondPerPulse,r=Math.floor(e*t.pulsePerSecond)+(n?1:0);return new P(r,t)},P.fromPulse=function(e,t){return new P(e,t)},P.fromBarNotation=function(e,t){var n=0;return e.split(":").forEach((function(e,r){var o=Math.floor(4*t.ppb/(1<<2*r));n+=Number(e)*o})),new P(n,t)};var M=function(e){Object(E.a)(n,e);var t=Object(x.a)(n);function n(e,r){var o;return Object(j.a)(this,n),(o=t.call(this,e,r.getResolution())).schedule=function(e,t){return o.scheduler.schedule(e,Object(H.a)(o),t)},o.scheduleLater=function(e,t,n){return o.add(t).schedule(e,n)},o.scheduleDraw=function(e){o.scheduler.scheduleDraw(e,Object(H.a)(o))},o.add=function(e){return new n(o.pulse+e.pulse,o.scheduler)},o.multiply=function(e){return new n(o.pulse*e,o.scheduler)},o.subtract=function(e){return new n(o.pulse-e.pulse,o.scheduler)},o.mod=function(e){return new n(o.pulse%e.pulse,o.scheduler)},o.toString=function(){return o.pulse===Number.POSITIVE_INFINITY?"time(Infinity)":"time(pulse=".concat(o.pulse,")")},o.justBefore=function(){return new n(o.pulse-1,o.scheduler)},o.justAfter=function(){return new n(o.pulse+1,o.scheduler)},o.scheduler=r,o}return n}(P);M.fromTime=function(e,t){return new M(e.toPulse(),t)},M.fromSeconds=function(e,t){var n=P.fromSeconds(e,t.getResolution());return M.fromTime(n,t)},M.fromBarNotation=function(e,t){var n=P.fromBarNotation(e,t.getResolution());return M.fromTime(n,t)},M.fromPulse=function(e,t){var n=P.fromPulse(e,t.getResolution());return M.fromTime(n,t)};var F=new(function(e){Object(E.a)(n,e);var t=Object(x.a)(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=r.ppb,c=void 0===o?64:o,u=r.bpm,a=void 0===u?120:u,i=r.lookAhead,s=void 0===i?12:i;return Object(j.a)(this,n),(e=t.call(this)).debug=function(t){console.debug("[Scheduler]{".concat(e.now().toPulse(),"}: "),t)},e.isRunning=function(){return!e.doStop},e.getResolution=function(){return e.resolution},e.getNewEventId=function(){return e.lastScheduledEventId+=1,e.lastScheduledEventId},e._rescheduleDispatch=function(){clearTimeout(e.dispatchTimeoutID),e.doStop?e.dispatchTimeoutID=null:e.dispatchTimeoutID=setTimeout(e.dispatch,e.lookAhead.toSeconds()/2)},e.clear=function(){for(;!e.eventQueue.isEmpty();)e.eventQueue.poll()},e.stop=function(){e.doStop=!0,e.clear(),e.emit("stop")},e.start=function(){e.doStop=!1,e.emit("start"),e.dispatch()},e.dispatch=function(){for(;!e.doStop&&!e.eventQueue.isEmpty()&&e.eventQueue.peek().time.isBefore(e.now().add(e.lookAhead));){var t=e.eventQueue.poll(),n=t.time,r=t.id,o=e.callbackRegister[r],c=e.dataRegister[r];e.debug("Dispatching event with id ".concat(r," scheduled for pulse [").concat(n,"]")),o(n,c),e._cleanUp(r)}e._rescheduleDispatch()},e.schedule=function(t,n,r){Object(D.a)(n instanceof P,"Scheduling time must be Time object.");var o=e.getNewEventId();return e.eventQueue.add({time:n,id:o}),e.callbackRegister[o]=t,e.dataRegister[o]=r,e.debug("Scheduled event with id ".concat(o," for pulse  [").concat(n.toPulse(),"]")),o},e.unschedule=function(t){e.debug("Unscheduled event ".concat(t)),!t in e.callbackRegister&&console.warn("Removed inexistant event with id ",t),e.eventQueue.removeOne((function(e){return e.id===t})),e._cleanUp(t)},e._cleanUp=function(t){delete e.callbackRegister[t],delete e.dataRegister[t]},e.replaceScheduledCallback=function(t,n){Object(D.a)(t in e.callbackRegister,"Tried replacing data of inexistant event"),e.callbackRegister[t]=n},e.replaceEventData=function(t,n){Object(D.a)(t in e.dataRegister,"Tried replacing data of inexistant event"),e.dataRegister[t]=n},e.now=function(){return e.s(A.d().now())},e.scheduleDraw=function(e,t){A.a.schedule(e,t.toSeconds())},e.eventQueue=new B.a((function(e,t){return e.time.isBefore(t.time)})),e.resolution=new R(a,c),e.dispatchTimeoutID=null,e.p=function(t){return M.fromPulse(t,Object(H.a)(e))},e.s=function(t){return M.fromSeconds(t,Object(H.a)(e))},e.b=function(t){return M.fromBarNotation(t,Object(H.a)(e))},e.callbackRegister={},e.dataRegister={},e.lastScheduledEventId=0,e.doStop=!1,e.lookAhead=e.s(.001*s),e}return n}(A.b)),L=F.b,_=F.s,U=(F.p,_(Number.POSITIVE_INFINITY)),z=function(e){Object(r.useEffect)((function(){return F.on("start",e)}),[])},q=function(e){Object(r.useEffect)((function(){return F.on("stop",e)}),[])},V=function(e){var t=e.sourceX,n=e.sourceY,r=e.targetX,o=e.targetY,c=e.sourcePosition,u=e.targetPosition,a=e.style,i=e.id,s=Object(g.g)({sourceX:t,sourceY:n,sourcePosition:c,targetX:r,targetY:o,targetPosition:u});return Object(f.jsx)("path",{d:s,style:a,id:i})},Y={audio:function(e){var t=e.selected,n=Object(C.a)(e,["selected"]);return Object(r.useEffect)((function(){return O.connectNodes(n.sourceHandleId,n.targetHandleId),function(){return O.disconnectNodes(n.sourceHandleId,n.targetHandleId)}}),[]),Object(f.jsx)(V,Object(m.a)(Object(m.a)({},n),{},{style:{strokeWidth:3,fill:"none",stroke:t?"#555":"#cccc"}}))},bang:function(e){var t=e.selected,n=Object(C.a)(e,["selected"]);Object(r.useEffect)((function(){return v.connectNodes(n.sourceHandleId,n.targetHandleId),function(){return v.disconnectNodes(n.sourceHandleId,n.targetHandleId)}}),[]);var o=Object(r.useState)(!1),c=Object(b.a)(o,2),u=c[0],a=c[1],i=function(e){return F.scheduleDraw((function(){a(!0),setTimeout((function(){return a(!1)}),100)}),e)},s="edge(".concat(n.sourceHandleId,"-").concat(n.targetHandleId,")");Object(r.useEffect)((function(){return v.registerInputNode(s,i),function(){return v.deregisterInputNode(s)}}),[]),Object(r.useEffect)((function(){return v.connectNodes(n.sourceHandleId,s),function(){return v.disconnectNodes(n.sourceHandleId,s)}}),[]);var d=u?"orange":t?"#555":"#ccc";return Object(f.jsx)(V,Object(m.a)(Object(m.a)({},n),{},{style:{strokeWidth:3,fill:"none",stroke:d}}))}},Q=n(57),J=n(3),X=n(416),K=n(412),W=n(217),G=function(e,t,n){var o=function(e,t){var n,o=Object(r.useRef)();return Object(r.useEffect)((function(){o.current=e})),null!==(n=o.current)&&void 0!==n?n:t}(t,n);Object(r.useEffect)((function(){return e(o)}),[t]),Object(r.useEffect)((function(){return function(){return e(n)}}),[])},Z=function(e){return Object(f.jsx)(g.c,Object(m.a)(Object(m.a)({},e),{},{style:Object(m.a)(Object(m.a)({},e.style),{},{width:20,height:20,zIndex:-1},e.style)}))},$={top:"100% 100% 0 0",left:"100% 0 0 100%",right:"0 100% 100% 0",bottom:"0 0 100% 100%"},ee=function(e){var t=Object(r.useState)(!1),n=Object(b.a)(t,2),o=n[0],c=n[1],u=Object(r.useCallback)((function(e){return e.scheduleDraw((function(){c(!0),setTimeout((function(){return c(!1)}),100)}))}),[]),a=Object(r.useMemo)((function(){return"bangReceiverForHandleFlashing(".concat(e.id,")")}),[]);return Object(r.useEffect)((function(){return v.registerInputNode(a,u),function(){return v.deregisterInputNode(a)}}),[]),Object(r.useEffect)((function(){return v.connectNodes(e.id,a),function(){return v.disconnectNodes(e.id,a)}}),[]),Object(f.jsx)(Z,Object(m.a)(Object(m.a)({},e),{},{style:Object(m.a)({borderRadius:0,backgroundColor:o?"orange":"grey",border:0},e.style)}))},te=function(e){return Object(f.jsx)(Z,Object(m.a)(Object(m.a)({},e),{},{style:Object(m.a)({borderRadius:0,backgroundColor:"lightgrey",border:0},e.style)}))},ne={audio:function(e){return Object(f.jsx)(Z,Object(m.a)(Object(m.a)({},e),{},{style:{borderRadius:$[e.position],backgroundColor:"lightblue"}}))},bang:function(e){return"source"===e.type?Object(f.jsx)(ee,Object(m.a)({},e)):Object(f.jsx)(te,Object(m.a)({},e))}},re=function(e){var t=e.kind,n=e.parentId,o=Object(C.a)(e,["kind","parentId"]),c=Object(g.h)();if(Object(r.useEffect)((function(){return c(n)}),[o.style]),t in ne){var u=ne[t];return Object(f.jsx)(u,Object(m.a)({},o))}throw"Unknown handle kind ".concat(t)},oe=new Set,ce=function(e,t){var n,o;return o=n=function(t){Object(E.a)(o,t);var n=Object(x.a)(o);function o(e){var t;return Object(j.a)(this,o),(t=n.call(this,e)).pushHandle=function(e,n,r,o){var c={id:e,kind:n,type:r,position:o};t.setState((function(e){return{handles:[].concat(Object(I.a)(e.handles),[c])}}))},t.pullHandle=function(e){t.setState((function(t){return{handles:S.a.reject(t.handles,{id:e})}})),t.context.deleteEdgesConnectedToHandle(e)},t.toAudioNodeIdentifier=function(e){return"audioHandle(name='".concat(e,"', node='").concat(t.id,"')")},t.toBangInputNodeIdentifier=function(e){return"bangInputHandle(name='".concat(e,"', node='").concat(t.id,"')")},t.toBangOutputNodeIdentifier=function(e){return"bangOutputHandle(name='".concat(e,"', node='").concat(t.id,"')")},t.addAudioInputHandle=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top",o=t.toAudioNodeIdentifier(n);return O.registerNode(e,o),t.pushHandle(o,"audio","target",r),o},t.removeAudioInputHandle=function(e){var n=t.toAudioNodeIdentifier(e);O.deregisterNode(n),t.pullHandle(n)},t.addAudioOutputHandle=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"bottom",o=t.toAudioNodeIdentifier(n);return O.registerNode(e,o),t.pushHandle(o,"audio","source",r),o},t.removeAudioOutputHandle=function(e){var n=t.toAudioNodeIdentifier(e);O.deregisterNode(n),t.pullHandle(n)},t.addBangInputHandle=function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"left",o=t.toBangInputNodeIdentifier(n);return v.registerInputNode(o,e),t.pushHandle(o,"bang","target",r),o},t.removeBangInputHandle=function(e){var n=t.toBangInputNodeIdentifier(e);v.deregisterInputNode(n),t.pullHandle(n)},t.addBangOutputHandle=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right",r=t.toBangOutputNodeIdentifier(e),o=v.registerOutputNode(r);return t.pushHandle(r,"bang","source",n),[r,o]},t.removeBangOutputHandle=function(e){var n=t.toBangInputNodeIdentifier(e);v.deregisterOutputNode(n),t.pullHandle(n)},t.componentDidMount=function(){oe.add(Object(H.a)(t))},t.componentWillUnmount=function(){oe.delete(Object(H.a)(t))},t.getAsReactFlowElement=function(){return{data:t.getData(),id:t.id,type:t.type}},t.id=e.id,t.type=e.type,t.state={title:"",handles:[]},t}return Object(J.a)(o,[{key:"render",value:function(){var t=this,n=Object(f.jsx)(e,{useTitle:function(e){return Object(r.useEffect)((function(){return t.setState({title:e})}),[e])},useData:function(e,n,o){var c,u,a=null!==(c=(null!==(u=t.props.data)&&void 0!==u?u:{})[n])&&void 0!==c?c:e,i=Object(r.useState)(!1),s=Object(b.a)(i,2),d=s[0],l=s[1];return[a,function(e){var r=e instanceof Function?e(a):e;t.context.setNodeData(t.id,Object(m.a)(Object(m.a)({},t.props.data),{},Object(Q.a)({},n,r))),l(!d)}]},useAudioInputHandle:function(e,n,o){Object(r.useEffect)((function(){return t.addAudioInputHandle(e,n,o),function(){return t.removeAudioInputHandle(n)}}),[])},useAudioOutputHandle:function(e,n,o){Object(r.useEffect)((function(){return t.addAudioOutputHandle(e,n,o),function(){t.removeAudioOutputHandle(n)}}),[])},useBangInputHandle:function(e,n,o){Object(r.useEffect)((function(){return t.addBangInputHandle(e,n,o),function(){t.removeBangInputHandle(n)}}),[])},useBangOutputHandle:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"right",o=Object(r.useState)((function(){return t.toBangOutputNodeIdentifier(e)})),c=Object(b.a)(o,1),u=c[0],a=Object(r.useState)((function(){return v.registerOutputNode(u)})),i=Object(b.a)(a,1),s=i[0];return Object(r.useEffect)((function(){return t.pushHandle(u,"bang","source",n),function(){return v.deregisterOutputNode(u)}}),[]),s},useBangOutputHandles:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"bang-handle",o=Object(r.useMemo)((function(){return Object(I.a)(Array(e).keys()).map((function(e){return"".concat(n,"-").concat(e)}))}),[e]),c=Object(r.useMemo)((function(){return o.map((function(e){return t.toBangOutputNodeIdentifier(e)}))}),[o]),u=Object(r.useMemo)((function(){return c.map((function(e){return v.getTriggerCallbackForOutputNode(e)}))}),[c]);return G((function(e){var n=c.slice(e.length),r=e.slice(c.length);n.map((function(e){v.registerOutputNode(e),t.pushHandle(e,"bang","source","right")})),r.map((function(e){v.deregisterOutputNode(e),t.pullHandle(e)}))}),c,[]),u}},this.id),o={border:"1px solid ".concat(this.props.selected?"black":"lightgrey"),minWidth:"30px",minHeight:"30px",fontSize:"smaller",borderRadius:"2px",boxShadow:"0px 0px 1px lightgrey",backgroundColor:"white",margin:"10px"},c=(K.a,X.a,{left:40,right:40}),u=function(e){var t=c[e];return c[e]+=22,"".concat(t,"px")};return Object(f.jsxs)("div",{style:o,children:[this.state.handles.map((function(e){return Object(r.createElement)(re,Object(m.a)(Object(m.a)({},e),{},{key:e.id,parentId:t.id,style:{top:u(e.position)}}))})),Object(f.jsx)("div",{style:{backgroundColor:"rgb(235, 235, 235)",fontSize:"x-small",padding:"2px",paddingLeft:"6px",minHeight:"7px"},children:this.state.title}),Object(f.jsx)("div",{style:{padding:"3px",cursor:"pointer"},className:"nodrag",children:n})]},this.id)}}]),o}(r.Component),n.contextType=k,o},ue=n(221),ae=n(414),ie=n(415),se=n(410),de=function(e){return Object(f.jsx)(se.a,Object(m.a)(Object(m.a)({min:1,size:"small",precision:0,step:1},e),{},{style:Object(m.a)({width:50},e.style)}))},le=(n(165),n(53),n(310),function e(t){var n=this;Object(j.a)(this,e),this.getUniqueEventId=function(){var e;return n.eventIdCounter=(null!==(e=n.eventIdCounter)&&void 0!==e?e:0)+1,n.eventIdCounter},this.schedule=function(e){Object(D.a)(!n.isScheduled(e),"Tried scheduling already schedueld event");var t=n.tpEvents[e],r=t.tptime,o=t.callback,c=t.data,u=r.add(n.glStartTime),a=u.schedule((function(t,r){delete n.tp2glEvents[e],o(t,r)}),c);n.tp2glEvents[e]={glid:a,gltime:u}},this.start=function(e){n.glStartTime=e,Object.keys(n.tpEvents).forEach((function(e){n.isScheduled(e)&&n.unschedule(e),n.schedule(e)})),n.nextControlEventId&&F.unschedule(n.nextControlEventId),n.interval.isBefore(U)&&(n.nextControlEventId=e.add(n.interval).schedule(n.start))},this.stop=function(e){n.nextControlEventId&&F.unschedule(n.nextControlEventId),Object.entries(n.tp2glEvents).forEach((function(t){var r=Object(b.a)(t,2),o=r[0];r[1].gltime.isAfter(e)&&n.isScheduled(o)&&n.unschedule(o)}))},this.isRunning=function(){return n.glStartTime.isBefore(F.now())},this.isScheduled=function(e){return e in n.tp2glEvents},this.addEvent=function(e,t,r){var o=n.getUniqueEventId();n.tpEvents[o]={callback:t,data:r,tptime:e},n.isRunning()&&n.getTpNow().isOnOrBefore(e)&&n.schedule(o)},this.removeEvent=function(e){n.isScheduled(e)&&n.unschedule(e),delete n.tpEvents[e]},this.removeAllEvents=function(){Object.keys(n.tpEvents).forEach((function(e){return n.removeEvent(e)}))},this.setEventData=function(e,t){if(n.isScheduled(e)){var r=n.tp2glEvents[e].glid;F.replaceEventData(r,t)}n.tpEvents[e]=Object(m.a)(Object(m.a)({},n.tpEvents[e]),{},{data:t})},this.setEventCallback=function(e,t){if(n.isScheduled(e)){var r=n.tp2glEvents[e].glid;F.replaceEventCallback(r,t)}n.tpEvents[e]=Object(m.a)(Object(m.a)({},n.tpEvents[e]),{},{callback:t})},this.setLoopInterval=function(e){if(n.interval=e,n.nextControlEventId&&F.unschedule(n.nextControlEventId),n.interval.isBefore(U)&&n.isRunning()){var t=F.now(),r=n.getTpNow(t),o=t.subtract(n.glStartTime),c=t.subtract(o.mod(e));n.glStartTime=c,Object.keys(n.tp2glEvents).forEach((function(e){return n.unschedule(e)})),Object.entries(n.tpEvents).forEach((function(e){var t=Object(b.a)(e,2),o=t[0];t[1].tptime.isOnOrAfter(r)&&n.schedule(o)})),n.nextControlEventId=c.add(e).schedule(n.start)}},this.getTpNow=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:F.now();return e.subtract(n.glStartTime)},this.unschedule=function(e){var t=n.tp2glEvents[e].glid;F.unschedule(t),delete n.tp2glEvents[e]},this.tpEvents={},this.tp2glEvents={},this.interval=null!==t&&void 0!==t?t:U,this.nextControlEventId=null,this.glStartTime=U,F.on("stop",(function(){return n.stop(_(0))}))}),fe=function e(t,n){var r=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],c=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];Object(j.a)(this,e),this.debug=function(e){console.debug("[StepSequencer]{".concat(F.now().toPulse(),"} ").concat(e))},this.setValues=function(e){r.debug("Set new values"),r.values=e,r.transport.removeAllEvents();var t=function(e,t){var n=t.v,o=t.i;return r.callback(e,n,o)};r.values.forEach((function(e,n){return r.transport.addEvent(r.interval.multiply(n),t,{v:e,i:n})})),r.setInterval(r.interval)},this.setCallback=function(e){r.callback=e},this.setInterval=function(e){r.interval=e,r.doLoop?r.transport.setLoopInterval(r.interval.multiply(Math.max(1,r.values.length))):r.transport.setLoopInterval(U)},this.setDoLoop=function(e){r.doLoop=e,r.setInterval(r.interval)},this.start=function(e){return r.transport.start(e)},this.stop=function(e){return r.transport.stop(e)},this.callback=t,this.interval=n,this.values=o,this.doLoop=c,this.transport=new le,this.setInterval(n),this.setDoLoop(c),this.setCallback(t),this.setValues(o)},pe=function(e){var t=e.isToggled,n=e.toggle,r=e.isActive;return Object(f.jsx)("div",{style:{width:20,height:20,border:"4px solid ".concat(r?"orange":"transparent"),backgroundColor:t?"#555":"#bbb",margin:2,padding:0,display:"inline-block",borderRadius:"1px"},onClick:n})},be={sequencer:function(e){var t=e.useData,n=e.useBangInputHandle,o=e.useBangOutputHandles;(0,e.useTitle)("Sequencer");var c=t(16,"no-cols"),u=Object(b.a)(c,2),a=u[0],i=u[1],s=t(2,"no-rows"),d=Object(b.a)(s,2),l=d[0],p=d[1],h=t(Array(a).fill().map((function(){return Array(l).fill(!1)})),"bang-grid"),g=Object(b.a)(h,2),j=g[0],O=g[1];Object(r.useEffect)((function(){O((function(e){var t=e.length,n=e[0].length,r=Object(I.a)(e);if(t<a){var o=Array(a-t).fill().map((function(){return Array(n).fill(!1)}));r=[].concat(Object(I.a)(e),Object(I.a)(o))}else t>a&&(r=r.slice(0,a));return n<l?r=r.map((function(e){var t=Array(l-n).fill(!1);return[].concat(Object(I.a)(e),Object(I.a)(t))})):n>l&&(r=r.map((function(e){return e.slice(0,l)}))),r}))}),[a,l]);var v=Object(r.useState)(-1),m=Object(b.a)(v,2),E=m[0],x=m[1],y=o(l,"seq-out"),N=Object(r.useState)((function(){return new fe((function(){}),L("0:0:1"))})),k=Object(b.a)(N,1)[0],w=Object(r.useCallback)((function(e,t,n){t.map((function(t,n){t&&y[n](e)})),e.scheduleDraw((function(){return x(n)}))}),[y]);n((function(e){return k.start(e)}),"sequencer-start"),Object(r.useEffect)((function(){return k.setValues(j)}),[j]),Object(r.useEffect)((function(){return k.setCallback(w)}),[w]);var C=t(!0,"do-loop"),H=Object(b.a)(C,2),T=H[0],B=H[1];Object(r.useEffect)((function(){return k.setDoLoop(T)}),[T]),q((function(){return x(-1)}));var A=S.a.zip.apply(S.a,Object(I.a)(j));return Object(f.jsxs)(f.Fragment,{children:[Object(f.jsxs)(ie.b,{direction:"horizontal",style:{paddingLeft:2},children:[Object(f.jsx)(de,{defaultValue:l,onChange:function(e){return p(e)}})," x",Object(f.jsx)(de,{defaultValue:a,onChange:function(e){return i(e)}}),Object(f.jsx)(ae.a,{checked:T,onChange:function(e){return B(e.target.checked)}}),"Loop"]}),A.map((function(e,t){return Object(f.jsx)("div",{children:e.map((function(e,n){return Object(f.jsx)(pe,{isToggled:e,toggle:function(){return function(e,t){return O((function(n){return n.map((function(n,r){return r!==t?n:n.map((function(t,n){return n!==e?t:!t}))}))}))}(t,n)},isActive:E===n},n)}))},t)}))]})},urbang:function(e){var t=e.useTitle,n=e.useBangOutputHandle;t("UrBang");var o=Object(r.useState)(!1),c=Object(b.a)(o,2),u=c[0],a=c[1];z((function(){return a(!0)})),q((function(){return a(!1)}));var i=n("urbang-out");return z((function(){return F.now().add(_(.1)).schedule(i)})),u?Object(f.jsx)(ue.a,{onClick:function(){return F.stop()},children:"\ud83d\udfe6"}):Object(f.jsx)(ue.a,{onClick:function(){return F.start()},children:"\ud83d\udca5"})},sampler:function(e){var t=e.useTitle,n=e.useAudioOutputHandle,o=e.useBangInputHandle,c=e.useData;t("Sampler");var u=function(e){var t=Object(r.useRef)();return function(){for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return void 0===t.current&&(t.current=Object(W.a)(e,r)),t.current}}(A.c)(),a=Object(r.useRef)();n(u.output,"audio-out"),o((function(e){return function(e){var t,n=null!==(t=a.current)&&void 0!==t?t:_(-1);n.isOnOrAfter(e)?console.error("Tried scheduling player playback in non-increasing fashion. Last playback: ".concat(n,", current playback: ").concat(e)):(a.current=e,u.start(e.toSeconds()))}(e)}),"player-start");var s=c(!1,"loop"),d=Object(b.a)(s,2),l=d[0],p=d[1],g=c("808/Clap","path"),j=Object(b.a)(g,2),O=j[0],v=j[1];Object(r.useEffect)((function(){return u.set({loop:l})}),[l]);var m=Object(r.useState)(!1),I=Object(b.a)(m,2),E=I[0],x=I[1];return Object(r.useEffect)((function(){x(!1);var e="sounds/drums/".concat(O,".wav");u.load(e).then((function(){return x(!0)}))}),[O]),q((function(){return u.stop()})),Object(f.jsxs)(f.Fragment,{children:[Object(f.jsx)(i.a,{style:{width:"120px"},children:Object(f.jsx)(h.a,{onPressEnter:function(e){return v(e.target.value)},defaultValue:O})}),Object(f.jsx)(ae.a,{onChange:function(e){return p(e.target.checked)},checked:l,children:"Loop"}),Object(f.jsx)(ue.a,{onClick:function(){return u.start()},disabled:!E,children:"Play"})]})},audioout:function(e){var t=e.useAudioInputHandle;(0,e.useTitle)("Master"),t(A.e(),"master-in");var n=Object(r.useState)(!1),o=Object(b.a)(n,2),c=o[0],u=o[1];return Object(f.jsx)(ue.a,{onClick:function(){A.f(),u(!0)},type:c?"text":"default",children:"\ud83d\udd0a"})}};be=S.a.mapValues(be,(function(e){return ce(e)}));var he=function(e){var t=e.x,n=e.y,o=e.dissapear,c=e.visible,u=Object(r.useContext)(k),a=Object(f.jsx)("div",{style:{left:t+"px",top:n+"px",position:"absolute"},children:Object(f.jsx)(h.a,{placeholder:"Add new element...",onPressEnter:function(e){var r=e.target.value;u.createNode(r,{x:t,y:n}),e.target.blur()},autoFocus:!0,onBlur:function(){return o()}})});return c?a:Object(f.jsx)(f.Fragment,{})},ge=function(e){e.props;var t=Object(r.useContext)(k),n=Object(r.useCallback)((function(e){var n=e.source,r=e.sourceHandle,o=e.target,c=e.targetHandle;O.isAudioNode(r)&&O.isAudioNode(c)?t.createEdge(n,r,o,c,"audio"):v.isBangNode(r)&&v.isBangNode(c)?t.createEdge(n,r,o,c,"bang"):console.log("Can't connect handles ",r,"and",c,"of different types")}),[t]),o=Object(r.useCallback)((function(e){e.map((function(e){return t.deleteElement(e)}))})),c=Object(r.useCallback)((function(e){e.preventDefault(),e.dataTransfer.dropEffect="move"}),[]),u=Object(r.useCallback)((function(e){e.preventDefault();var n=JSON.parse(e.dataTransfer.getData("audio-tool/node-preset")),r=n.type,o=n.data,c=t.reactFlowInstance.project({x:e.clientX,y:e.clientY});t.createNode(r,c,o)}),[t]),a=Object(r.useState)({visible:!1}),i=Object(b.a)(a,2),s=i[0],d=s.visible,l=s.x,p=s.y,h=i[1],j=Object(r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),h({visible:!0,x:e.pageX-20,y:e.pageY-25})}),[]);return Object(f.jsxs)(g.e,{children:[Object(f.jsxs)(g.f,{elements:t.elements,nodeTypes:be,edgeTypes:Y,onLoad:t.setReactFlowInstance,onConnect:n,deleteKeyCode:"Delete",onElementsRemove:o,onDragOver:c,onDrop:u,onPaneContextMenu:j,children:[Object(f.jsx)(g.a,{variant:"dots",gap:24,size:.5}),Object(f.jsx)(g.d,{}),Object(f.jsx)(g.b,{})]}),Object(f.jsx)(he,{visible:d,x:l,y:p,dissapear:function(){return h({visible:!1})}})]})},je={elements:[{id:"urbang",type:"urbang",position:{x:100,y:100}},{id:"audioout",type:"audioout",position:{x:300,y:300}}],position:[0,0],zoom:1},Oe="audio-tool",ve=function(){var e=Object(r.useContext)(k),t=Object(r.useCallback)((function(t){var n;e.setElements(t.elements);var r={x:t.position[0],y:t.position[1]+100,zoom:t.zoom};null===(n=e.reactFlowInstance)||void 0===n||n.setTransform(r)}),[e]),n=Object(r.useCallback)((function(){return e.reactFlowInstance.toObject()})),o=Object(r.useCallback)((function(){localStorage.setItem(Oe,JSON.stringify(n()))}),[e]),c=Object(r.useCallback)((function(){var e,n=null!==(e=JSON.parse(localStorage.getItem(Oe)))&&void 0!==e?e:je;t(n),console.log("Loaded config",n)}),[e]),u=Object(r.useCallback)((function(){t(je)}),[e]);return Object(r.useEffect)((function(){return e.reactFlowInstance&&c()}),[e.reactFlowInstance]),Object(f.jsx)(h.a.Group,{style:{padding:5},children:Object(f.jsxs)(a.a,{gutter:5,children:[Object(f.jsx)(i.a,{children:Object(f.jsx)(ue.a,{onClick:function(){return o()},children:"Save"})}),Object(f.jsx)(i.a,{children:Object(f.jsx)(ue.a,{onClick:function(){return c()},children:"Load"})}),Object(f.jsx)(i.a,{children:Object(f.jsx)(ue.a,{onClick:function(){return u()},children:"Reset"})})]})})};var me=function(){return Object(f.jsxs)(a.a,{children:[Object(f.jsx)(i.a,{span:18,style:{height:"900px"},children:Object(f.jsxs)(w,{children:[Object(f.jsx)(ve,{}),Object(f.jsx)(ge,{})]})}),Object(f.jsx)(i.a,{span:6,children:Object(f.jsx)(p,{})})]})},Ie=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,417)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,c=t.getLCP,u=t.getTTFB;n(e),r(e),o(e),c(e),u(e)}))};u.a.render(Object(f.jsx)(o.a.StrictMode,{children:Object(f.jsx)(me,{})}),document.getElementById("root")),Ie()}},[[397,1,2]]]);
//# sourceMappingURL=main.6aeadc2f.chunk.js.map